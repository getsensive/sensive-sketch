var that=this;function __skpm_run(e,t){that.context=t;var n=function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s="./src/my-command.js")}({"./node_modules/@skpm/timers/immediate.js":
/*!************************************************!*\
  !*** ./node_modules/@skpm/timers/immediate.js ***!
  \************************************************/
/*! no static exports found */function(e,t,n){var o=n(/*! ./timeout */"./node_modules/@skpm/timers/timeout.js");e.exports={setImmediate:function(e,t,n,r,i,c,s,a,u,l,d){return o.setTimeout(e,0,t,n,r,i,c,s,a,u,l,d)},clearImmediate:function(e){return o.clearTimeout(e)}}},"./node_modules/@skpm/timers/test-if-fiber.js":
/*!****************************************************!*\
  !*** ./node_modules/@skpm/timers/test-if-fiber.js ***!
  \****************************************************/
/*! no static exports found */function(e,t){e.exports=function(){return"undefined"!=typeof coscript&&coscript.createFiber}},"./node_modules/@skpm/timers/timeout.js":
/*!**********************************************!*\
  !*** ./node_modules/@skpm/timers/timeout.js ***!
  \**********************************************/
/*! no static exports found */function(e,t,n){var o,r,i=[];if(n(/*! ./test-if-fiber */"./node_modules/@skpm/timers/test-if-fiber.js")()){i=[];o=function(e,t,n,o,r,c,s,a,u,l,d,f){var p=i.length;return i.push(coscript.scheduleWithInterval_jsFunction((t||0)/1e3,function(){e(n,o,r,c,s,a,u,l,d,f)})),p},r=function(e){var t=i[e];t&&(t.cancel(),i[e]=void 0)}}else o=function(e,t,n,o,c,s,a,u,l,d,f,p){coscript.shouldKeepAround=!0;var h=i.length;return i.push(!0),coscript.scheduleWithInterval_jsFunction((t||0)/1e3,function(){i[h]&&e(n,o,c,s,a,u,l,d,f,p),r(h),i.every(function(e){return!e})&&(coscript.shouldKeepAround=!1)}),h},r=function(e){i[e]=!1};e.exports={setTimeout:o,clearTimeout:r}},"./node_modules/cocoascript-class/lib/index.js":
/*!*****************************************************!*\
  !*** ./node_modules/cocoascript-class/lib/index.js ***!
  \*****************************************************/
/*! no static exports found */function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SuperCall=void 0,t.default=function(e){const t=e.superclass||NSObject,n=(e.className||e.classname||"ObjCClass")+NSUUID.UUID().UUIDString(),i=new Set(["className","classname","superclass"]);var c=MOClassDescription.allocateDescriptionForClassWithName_superclass_(n,t);const s=[];for(var a in e){const t=e[a];if("function"==typeof t&&"init"!==a){var u=NSSelectorFromString(a);c.addInstanceMethodWithSelector_function_(u,t)}else i.has(a)||(s.push(a),c.addInstanceVariableWithName_typeEncoding(a,"@"))}return c.addInstanceMethodWithSelector_function_(NSSelectorFromString("init"),function(){const t=r.call(this);return s.map(n=>{Object.defineProperty(t,n,{get:()=>(function(e,t){const n=MOPointer.new();return(0,o.object_getInstanceVariable)(e,t,n),n.value().retain().autorelease()})(t,n),set(e){(0,o.object_setInstanceVariable)(t,n,e)}}),t[n]=e[n]}),"function"==typeof e.init&&e.init.call(this),t}),c.registerClass()};var o=n(/*! ./runtime.js */"./node_modules/cocoascript-class/lib/runtime.js");t.SuperCall=o.SuperCall;const r=(0,o.SuperCall)(NSStringFromSelector("init"),[],{type:"@"})},"./node_modules/cocoascript-class/lib/runtime.js":
/*!*******************************************************!*\
  !*** ./node_modules/cocoascript-class/lib/runtime.js ***!
  \*******************************************************/
/*! no static exports found */function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SuperCall=function(e,t,n){const r=i("objc_msgSendSuper",[{type:"^"+o},{type:":"},...t],n);return function(...t){const n=function(e,t){return function e(t){if("object"!=typeof t||0==Object.keys(t).length)return t;const n=Object.keys(t)[0];const o=t[n];const r=MOStruct.structureWithName_memberNames_runtime(n,Object.keys(o),Mocha.sharedRuntime());Object.keys(o).map(t=>{r[t]=e(o[t])});return r}({objc_super:{receiver:e,super_class:t}})}(this,this.superclass()),o=MOPointer.alloc().initWithValue_(n);return r(o,e,...t)}},t.CFunc=i;const o='{objc_super="receiver"@"super_class"#}';function r(e,t){const n=NSMutableDictionary.dictionary();n.o=e,Object.keys(t).map(e=>n.setValue_forKeyPath(t[e],"o."+e))}function i(e,t,n){function o(e){if(!e)return null;const t=MOBridgeSupportArgument.alloc().init();return r(t,{type64:e.type}),t}const i=MOBridgeSupportFunction.alloc().init();return r(i,{name:e,arguments:t.map(o),returnValue:o(n)}),i}t.object_getInstanceVariable=i("object_getInstanceVariable",[{type:"@"},{type:"*"},{type:"^@"}],{type:"^{objc_ivar=}"}),t.object_setInstanceVariable=i("object_setInstanceVariable",[{type:"@"},{type:"*"},{type:"@"}],{type:"^{objc_ivar=}"});!function(e,t){const n=MOBridgeSupportController.sharedController().valueForKey("symbols");if(!n)throw Error("Something has changed within bridge support so we can't add our definitions");if(null!==n[e])return;const o=MOBridgeSupportStruct.alloc().init();r(o,{name:e,type:t.type}),n[e]=o}("objc_super",{type:o})},"./node_modules/promise-polyfill/lib/index.js":
/*!****************************************************!*\
  !*** ./node_modules/promise-polyfill/lib/index.js ***!
  \****************************************************/
/*! no static exports found */function(e,t,n){"use strict";(function(t,n){var o=t;function r(){}function i(e){if(!(this instanceof i))throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],l(e,this)}function c(e,t){for(;3===e._state;)e=e._value;0!==e._state?(e._handled=!0,i._immediateFn(function(){var n=1===e._state?t.onFulfilled:t.onRejected;if(null!==n){var o;try{o=n(e._value)}catch(e){return void a(t.promise,e)}s(t.promise,o)}else(1===e._state?s:a)(t.promise,e._value)})):e._deferreds.push(t)}function s(e,t){try{if(t===e)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var n=t.then;if(t instanceof i)return e._state=3,e._value=t,void u(e);if("function"==typeof n)return void l(function(e,t){return function(){e.apply(t,arguments)}}(n,t),e)}e._state=1,e._value=t,u(e)}catch(t){a(e,t)}}function a(e,t){e._state=2,e._value=t,u(e)}function u(e){2===e._state&&0===e._deferreds.length&&i._immediateFn(function(){e._handled||i._unhandledRejectionFn(e._value)});for(var t=0,n=e._deferreds.length;t<n;t++)c(e,e._deferreds[t]);e._deferreds=null}function l(e,t){var n=!1;try{e(function(e){n||(n=!0,s(t,e))},function(e){n||(n=!0,a(t,e))})}catch(e){if(n)return;n=!0,a(t,e)}}i.prototype.catch=function(e){return this.then(null,e)},i.prototype.then=function(e,t){var n=new this.constructor(r);return c(this,new function(e,t,n){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=n}(e,t,n)),n},i.prototype.finally=function(e){var t=this.constructor;return this.then(function(n){return t.resolve(e()).then(function(){return n})},function(n){return t.resolve(e()).then(function(){return t.reject(n)})})},i.all=function(e){return new i(function(t,n){if(!e||void 0===e.length)throw new TypeError("Promise.all accepts an array");var o=Array.prototype.slice.call(e);if(0===o.length)return t([]);var r=o.length;function i(e,c){try{if(c&&("object"==typeof c||"function"==typeof c)){var s=c.then;if("function"==typeof s)return void s.call(c,function(t){i(e,t)},n)}o[e]=c,0==--r&&t(o)}catch(e){n(e)}}for(var c=0;c<o.length;c++)i(c,o[c])})},i.resolve=function(e){return e&&"object"==typeof e&&e.constructor===i?e:new i(function(t){t(e)})},i.reject=function(e){return new i(function(t,n){n(e)})},i.race=function(e){return new i(function(t,n){for(var o=0,r=e.length;o<r;o++)e[o].then(t,n)})},i._immediateFn="function"==typeof n&&function(e){n(e)}||function(e){o(e,0)},i._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)},e.exports=i}).call(this,n(/*! ./node_modules/@skpm/timers/timeout.js */"./node_modules/@skpm/timers/timeout.js").setTimeout,n(/*! ./node_modules/@skpm/timers/immediate.js */"./node_modules/@skpm/timers/immediate.js").setImmediate)},"./node_modules/sketch-polyfill-fetch/lib/index.js":
/*!*********************************************************!*\
  !*** ./node_modules/sketch-polyfill-fetch/lib/index.js ***!
  \*********************************************************/
/*! no static exports found */function(e,t,n){(function(t){var o,r,i=n(/*! cocoascript-class */"./node_modules/cocoascript-class/lib/index.js").default;try{o=n(/*! buffer */"buffer")}catch(e){}e.exports=function(e,n){var c;n=n||{};try{c=coscript.createFiber()}catch(e){coscript.shouldKeepAround=!0}return new t(function(s,a){var u,l=NSURL.alloc().initWithString(e),d=NSMutableURLRequest.requestWithURL(l);(d.setHTTPMethod(n.method||"GET"),Object.keys(n.headers||{}).forEach(function(e){d.setValue_forHTTPHeaderField(n.headers[e],e)}),n.body)&&("string"==typeof n.body?u=NSString.alloc().initWithString(n.body).dataUsingEncoding(NSUTF8StringEncoding):o&&o.isBuffer(n.body)?u=n.body.toNSData():n.body.isKindOfClass&&1==n.body.isKindOfClass(NSData)?u=n.body:(u=NSJSONSerialization.dataWithJSONObject_options_error(n.body,NSJSONWritingPrettyPrinted,void 0),d.setValue_forHTTPHeaderField(""+u.length(),"Content-Length")),d.setHTTPBody(u));if(n.cache)switch(n.cache){case"reload":case"no-cache":case"no-store":d.setCachePolicy(1);case"force-cache":d.setCachePolicy(2);case"only-if-cached":d.setCachePolicy(3)}n.credentials||d.setHTTPShouldHandleCookies(!1);var f=!1;r||(r=i({classname:"FetchPolyfillDelegate",data:null,httpResponse:null,fiber:null,callbacks:null,"connectionDidFinishLoading:":function(e){f=!0,this.callbacks.resolve(function e(n,r){for(var i,c=[],s=[],a={},u=0;u<n.allHeaderFields().allKeys().length;u++){var l=n.allHeaderFields().allKeys()[u].toLowerCase(),d=String(n.allHeaderFields()[l]);c.push(l),s.push([l,d]),i=a[l],a[l]=i?i+","+d:d}return{ok:1==(n.statusCode()/200|0),status:Number(n.statusCode()),statusText:NSHTTPURLResponse.localizedStringForStatusCode(n.statusCode()),useFinalURL:!0,url:String(n.URL().absoluteString()),clone:e.bind(this,n,r),text:function(){return new t(function(e,t){const n=NSString.alloc().initWithData_encoding(r,NSASCIIStringEncoding);n?e(n):t(new Error("Couldn't parse body"))})},json:function(){return new t(function(e,t){var n=NSString.alloc().initWithData_encoding(r,NSUTF8StringEncoding);n?e(JSON.parse(n)):t(new Error("Could not parse JSON because it is not valid UTF-8 data."))})},blob:function(){return t.resolve(r)},arrayBuffer:function(){return t.resolve(o.from(r))},headers:{keys:function(){return c},entries:function(){return s},get:function(e){return a[e.toLowerCase()]},has:function(e){return e.toLowerCase()in a}}}}(this.httpResponse,this.data)),this.fiber?this.fiber.cleanup():coscript.shouldKeepAround=!1},"connection:didReceiveResponse:":function(e,t){this.httpResponse=t,this.data=NSMutableData.alloc().init()},"connection:didFailWithError:":function(e,t){f=!0,this.callbacks.reject(t),this.fiber?this.fiber.cleanup():coscript.shouldKeepAround=!1},"connection:didReceiveData:":function(e,t){this.data.appendData(t)}}));var p=r.new();p.callbacks=NSDictionary.dictionaryWithDictionary({resolve:s,reject:a}),p.fiber=c;var h=NSURLConnection.alloc().initWithRequest_delegate(d,p);c&&c.onCleanup(function(){f||h.cancel()})})}}).call(this,n(/*! ./node_modules/promise-polyfill/lib/index.js */"./node_modules/promise-polyfill/lib/index.js"))},"./src/my-command.js":
/*!***************************!*\
  !*** ./src/my-command.js ***!
  \***************************/
/*! exports provided: onDocumentSaved, onArtboardChanged */function(e,t,n){"use strict";n.r(t),function(e){n.d(t,"onDocumentSaved",function(){return i}),n.d(t,"onArtboardChanged",function(){return c});var o=n(/*! sketch-polyfill-fetch */"./node_modules/sketch-polyfill-fetch/lib/index.js"),r=n(/*! sketch/settings */"sketch/settings");function i(t){var n=t.actionContext.document.findCurrentArtboardGroup();!0===r.documentSettingForKey(t.actionContext.document,"trackDocument")&&function(n,o){var r="/tmp/".concat(n.objectID(),".png"),i=MSExportRequest.exportRequestsFromExportableLayer(n).firstObject();i.scale=1,i.saveForWeb=!1,i.format="png",t.actionContext.document.saveArtboardOrSlice_toFile(i,r),console.log(r),e(function(){return o(r)},500)}(n,function(e,n){return function(i){var c=NSData.alloc().initWithContentsOfFile(i);t.actionContext.document.showMessage("Sending changes to Sensive…"),o(e,{method:"POST",headers:{"Content-Type":"image/png","X-User-Application-Token":r.settingForKey("userApplicationToken")},body:c}).then(function(e){!function(e,n){var i=t.actionContext.document,c=String(n.name()),s=String(n.objectID()),a=String(i.cloudName().toString()),u=String(i.cloudDocumentKey());console.log("artboardName:",c),console.log("artboardUid:",s),console.log("documentName:",a),console.log("documentUid:",u),o("http://localhost:5000/api/snapshots/sketch/",{method:"POST",headers:{"Content-Type":"application/json","X-User-Application-Token":r.settingForKey("userApplicationToken")},body:JSON.stringify({snapshot:{artboard_name:c,artboard_uid:s,document_name:a,document_uid:u,url:e}})}).then(function(e){console.log(e)}).then(function(e){t.actionContext.document.showMessage("Done!")}).catch(function(e){return console.log(e)})}(JSON.parse(e.text()._value).url,n)}).then(function(e){}).catch(function(e){return console.log(e)})}}("http://localhost:5000/api/images/upload",n))}function c(e){}}.call(this,n(/*! ./node_modules/@skpm/timers/timeout.js */"./node_modules/@skpm/timers/timeout.js").setTimeout)},buffer:
/*!*************************!*\
  !*** external "buffer" ***!
  \*************************/
/*! no static exports found */function(e,t){e.exports=require("buffer")},"sketch/settings":
/*!**********************************!*\
  !*** external "sketch/settings" ***!
  \**********************************/
/*! no static exports found */function(e,t){e.exports=require("sketch/settings")}});"default"===e&&"function"==typeof n?n(t):n[e](t)}that.onDocumentSaved=__skpm_run.bind(this,"onDocumentSaved"),that.onArtboardChanged=__skpm_run.bind(this,"onArtboardChanged"),that.onRun=__skpm_run.bind(this,"default");